<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-2024/compiler-lessons" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">compiler | LucasBlog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xbpk3t.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://xbpk3t.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://xbpk3t.github.io/2024/compiler"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="compiler | LucasBlog"><meta data-rh="true" name="description" content="Project5.pdf compiler优化"><meta data-rh="true" property="og:description" content="Project5.pdf compiler优化"><meta data-rh="true" name="robots" content="noindex, nofollow"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://xbpk3t.github.io/2024/compiler"><link data-rh="true" rel="alternate" href="https://xbpk3t.github.io/zh-Hans/2024/compiler" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://xbpk3t.github.io/2024/compiler" hreflang="en"><link data-rh="true" rel="alternate" href="https://xbpk3t.github.io/2024/compiler" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://RV6E9N0CVW-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-G0687BFERF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-G0687BFERF",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="LucasBlog" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.40e9e2cd.css">
<script src="/assets/js/runtime~main.78d9bf26.js" defer="defer"></script>
<script src="/assets/js/main.aa45b9ab.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Hacking" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Hacking" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Hacking</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Archive</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">2024</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/dockerfile-best-practices">Dockerfile 最佳实践</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/2024/compiler">compiler</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/geektime-lessons">速读几本极客时间课程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/reading-methods">《聪明的阅读者》读书笔记</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/monthly9">Monthly#9</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/mysql-lessons">《MySQL 45讲》读书笔记</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/goreleaser">用 goreleaser 代替 changelogithub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/tech-team-managing">《技术管理实战 36 讲》读书笔记</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/flomo-bulk-delete">flomo批量删除脚本</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/deprecated-commands">【存档】备份一些repo命令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/alfred-vs">alfred-vs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/alternate-print">多线程轮流打印问题</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024">s</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/running">running</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/Design-Pattern">设计模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/code-spec">代码规范</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/regex">regex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/ssh-protocol">ssh协议</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/tcpdump">tcpdump</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/xq">相亲</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/zhihu">知乎文章摘录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/buy-byd-seal-06gt">【海豹06GT】购车记录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/feed-manage-2">信息源管理2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/monthly8">Monthly#8</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/sun-zi">《孙子兵法》读书笔记</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/system-design-interview">《搞定系统设计：面试敲开大厂的门》</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/how-to-write-commentary">《时评写作十讲》读书笔记</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/how-to-write-book-review">怎么写书评？</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/zai-zhi-tian-xia">《宰执天下》书评</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/wechat-read-app">微信读书APP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/golang-error">golang错误处理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/record-for-paris-olympics">巴黎奥运会纪录</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/sql">常用mysql sql整理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/pre-commit">为什么在CI中应该用pre-commit代替linters?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/argumentative-writing">议论文</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/feed-manage-1">信息源管理1（rss）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/shell-syntax">shell脚本常用语法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/weekly13">Weekly#13</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/politics-of-legitimacy">《合法性的政治》读书笔记</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2024/leng-jing">【Hac棱镜】文章合集</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">2023</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2023/weekly52">Weekly#52</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2023/weekly40">Weekly#40</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2023/kernel">《趣谈 Linux 操作系统》读书笔记</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2023/network-protocol">network-protocol</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2023/secretary-work-handbook">《秘书工作手记》读书笔记</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2023/capital-in-the-twenty-first-century">《21世纪资本论》读书笔记</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2023/ru-zi-di">《孺子帝》读后感</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2023/renamer-tool">文件批量重命名工具</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2023/feng-hua-marathon">复盘奉化马拉松</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">2000</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/minimalist">极简生活</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/books">books.yml</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs">docs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/movies">movies.yml</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/music">music常识</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tv">tv.yml</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/x">x</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning theme-unlisted-banner"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Unlisted page</div><div class="admonitionContent_BuS1">This page is unlisted. Search engines will not index it, and only users having a direct link can access it.</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">2024</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">compiler</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>compiler</h1><div class="container_mg8B margin-vert--md"><time datetime="2024-10-24">October 24, 2024</time></div></header><div class="toolbar_VBrL"></div><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 《编译原理之美》</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 《编译原理实战课》</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 《用Go语言自制编译器》</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 《用Go语言自制解释器》</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 《编译原理》</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">author</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 阿霍</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 《高级编译器设计与实现》</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 《编译器设计》</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">author</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Keith Cooper</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://cs.nju.edu.cn/changxu/2_compiler/projects/Project_5.pdf" target="_blank" rel="noopener noreferrer">Project_5.pdf</a> compiler优化</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="编译原理之美">《编译原理之美》<a href="#编译原理之美" class="hash-link" aria-label="Direct link to 《编译原理之美》" title="Direct link to 《编译原理之美》">​</a></h2>
<p><a href="https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E4%B9%8B%E7%BE%8E" target="_blank" rel="noopener noreferrer">编译原理之美</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="编译原理实战课">《编译原理实战课》<a href="#编译原理实战课" class="hash-link" aria-label="Direct link to 《编译原理实战课》" title="Direct link to 《编译原理实战课》">​</a></h2>
<p><a href="https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E5%AE%9E%E6%88%98%E8%AF%BE" target="_blank" rel="noopener noreferrer">编译原理实战课</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="用go语言自制编译器">《用Go语言自制编译器》<a href="#用go语言自制编译器" class="hash-link" aria-label="Direct link to 《用Go语言自制编译器》" title="Direct link to 《用Go语言自制编译器》">​</a></h2>
<p>《用Go语言自制编译器》和《用Go语言自制解释器》</p>
<p><a href="https://github.com/OctopusLian/monkey" target="_blank" rel="noopener noreferrer">OctopusLian/monkey: 《用Go语言自制解释器+编译器》</a></p>
<p><a href="https://github.com/PiNengShaoNian/monkey-go" target="_blank" rel="noopener noreferrer">PiNengShaoNian/monkey-go: 用Go语言自制解释器，用Go语言自制编译器go代码</a></p>
<p><a href="https://github.com/yonh/go-monkey-interpreter" target="_blank" rel="noopener noreferrer">yonh/go-monkey-interpreter: 用Go语言自制解释器</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="高级编译器设计与实现">《高级编译器设计与实现》<a href="#高级编译器设计与实现" class="hash-link" aria-label="Direct link to 《高级编译器设计与实现》" title="Direct link to 《高级编译器设计与实现》">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="编译器设计">《编译器设计》<a href="#编译器设计" class="hash-link" aria-label="Direct link to 《编译器设计》" title="Direct link to 《编译器设计》">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="wip-golang-compiler">[WIP] golang compiler<a href="#wip-golang-compiler" class="hash-link" aria-label="Direct link to [WIP] golang compiler" title="Direct link to [WIP] golang compiler">​</a></h2>
<ul>
<li>golang 编译由哪几个阶段构成？</li>
<li><em>对 golang 编译器有哪些优化？</em></li>
<li>怎么通过 AST 树对 golang 源码进行分析？</li>
</ul>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>怎么学习“编译原理”？</summary><div><div class="collapsibleContent_i85q"><ul>
<li>我们想要学习编译原理，也只是想自己写一个编译器，从而更好地理解 这些高级语言。但是，对于新手，一开始就写编译器不一定是很好的选择，因为编译器的重点在于后端，而后端知识对于普通程序员而言用处不大。</li>
<li>应该尝试实现一个简单但是完整的编译器，尽早尽快地把编译器的整个流程过一遍，从而在整体上形成对编译器的认识。而不是看太多理论知识。</li>
<li>先学习解释器的实现，这样可以把学习重点放在类型、作用域等知识上，所谓解释器就是直接在语法树上运行，而不编译为目标语言，推荐一本很好的书：Essentials of Programming Languages，该书同为实践向教材，浅入深地讲解了各种解释器的实现，内容覆盖了环境的表示、continuation、类型检查、类型推导、OO 语言的基本实现</li>
</ul></div></div></details>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p>编译原理相关的知识，其实对普通程序员而言用处不大。</p><p>因为compiler的重点是后端，而后端对普通开发没啥用。应该先学着写一个interpreter，然后再实现一个简单而完整的compiler，基本上就足够了。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="golang-编译由哪几个阶段构成">golang 编译由哪几个阶段构成？<a href="#golang-编译由哪几个阶段构成" class="hash-link" aria-label="Direct link to golang 编译由哪几个阶段构成？" title="Direct link to golang 编译由哪几个阶段构成？">​</a></h3>
<p><em>由<code>词法分析</code>、<code>语法分析</code>、<code>类型检查</code>、<code>生成中间码</code>、<code>生成机器码</code>这 5 个阶段构成</em></p>
<p>编译前端</p>
<ol>
<li><code>词法分析</code>，把源码翻译成 token，token 分为变量名、字面量、操作符、分隔符和关键字。早期 golang 使用通用词法分析器 lex，后来改用了 golang 自己实现的。</li>
<li><code>语法分析</code>，将 token 转成 AST 树，有<code>包名ast.Indent</code>、<code>导入声明ast.GenDecl</code>、<code>函数声明ast.FuncDecl</code>三个子节点</li>
<li><code>类型检查</code></li>
</ol>
<p>编译后端</p>
<ol>
<li><code>生成中间码</code>，AST 转 IR(中间码)，golang 使用<code>SSA特性的IR</code>，这种形式的中间码，最重要的一个特性就是在使用变量之前总是定义变量，并且每个变量只分配一次</li>
<li><code>生成机器码</code>，<em>优化后的中间码，首先会被转成汇编代码 (Plan9)，而汇编代码只是机器码的文本表示，还不能执行。所以这个阶段会调用汇编器，汇编器会根据我们在执行编译时设置的架构，调用对应代码来生成目标机器码</em></li>
</ol>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> 编译和解释（重要）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">解释型语言和编译型语言有什么区别？</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token italic content">编译和解释的区别只在于代码是什么时候被翻译成目标 CPU 的指令的</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token plain">，编译型语言在编译过程中生成目标平台的指令，解释型语言在运行过程中才生成目标平台的指令。(虚拟机的任务是在运行过程中将中间代码翻译成目标平台的指令)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C/C++ 都是编译型语言，而 java/C#/PHP 都是解释型语言</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 虽然 java 在运行之前也有一个编译过程，但是并不是将代码编译成机器语言，而是编译成字节码，在运行的时候，由 JVM 将字节码再翻译成编译码，机器可以直接执行。python 同样。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> js、PHP 之类的脚本语言不需要编译，可以直接使用，由解释器负责解释</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 只说语言本身，PHP 和 java 都解释执行的时候，其实是一样的，都是先编译执行再解释执行，唯一的区别在于 java 是先编译，运行时直接在 jvm 里编译成机器码；但是 PHP 运行时既需要解释执行也需要编译执行，带来的好处很多比如说热部署方便；坏处就在于性能变差；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 使用 sapi 解释执行 PHP 时，通过 zend 转 opcode 码，再转为机器码；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> java 则是运行前 JVM 先转为 bytecode(其实也是 opcode)，运行的时候 JVM 再将 bytecode 转为机器码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="对-golang-编译器有哪些优化">对 golang 编译器有哪些优化？<a href="#对-golang-编译器有哪些优化" class="hash-link" aria-label="Direct link to 对 golang 编 译器有哪些优化？" title="Direct link to 对 golang 编译器有哪些优化？">​</a></h3>
<ul>
<li>详述 golang 编译器执行全流程？</li>
<li>执行 golang 可执行文件时，发生了什么？</li>
</ul>
<hr>
<ul>
<li>golang 编译器的历史？go1.7 之前使用<code>AST覆盖</code>的编译技术，go1.7 之后使用主流的基于 SSA-IR 的<code>SSA</code></li>
</ul>
<p>词法分析：8 个 bit 为一组，对应一个字符，按照 ASCII 表查出来</p>
<p>熟悉不同编译优化技术，如 IPA、LTO、PGO、FDO 等；理解部分编译优化概念，如 SSA、Alias Analysis、Dependence Analysis、Vectorization、Data-flow</p>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> 编译优化</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">编译器优化有哪些方法？</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 常量传播 cp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 常量折叠 cf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 死码消除</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 公共子表达式消除 CSE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 循环不变代码移动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 更好的寄存器分配</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BCE(Bounds Check Elimination)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ssa-是什么及其特点">SSA 是什么？及其特点？<a href="#ssa-是什么及其特点" class="hash-link" aria-label="Direct link to SSA 是什么？及其特点？" title="Direct link to SSA 是什么？及其特点？">​</a></h3>
<p><em>SSA-IR（Single Static Assignment）是一种介于高级语言和汇编语言的中间形态的伪语言</em></p>
<ul>
<li><code>Single</code>：每个表达式只能做一个简单运算，对于复杂的表达式 <code>a*b+c*d</code> 要拆分成：<code>t0=a*b; t1=c*d; t2=t0+t1;</code> 三个简单表达式</li>
<li><code>Static</code>：每个变量只能赋值一次（因此应该叫常量更合适）</li>
<li>SSA 可以最大提高软件的可复用性，SSA 是产品级编译器的唯一解决方案，把 M*N 的问题转化成了 M+N</li>
<li><em>SSA 使用<code>BCE</code>(Bounds Check Elimination 边界检测消除) 和<code>CSE</code>(Common Subexpression Elimination) 优化可以让 golang 编译器生成更高效的代码</em></li>
</ul>
<hr>
<p><a href="https://darjun.github.io/2018/05/07/bounds-check-elimination/" target="_blank" rel="noopener noreferrer">深入理解 Go 之 BCE 优化 - 大俊的博客</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="内联">内联<a href="#内联" class="hash-link" aria-label="Direct link to 内联" title="Direct link to 内联">​</a></h3>
<p>什么是内联？</p>
<ul>
<li>内联是一个基本的编译器优化，<em>用被调用函数的主体替换函数调用，以消除调用开销，更重要的是启用了其他编译器优化</em>(这是在编译过程中自动执行的一种基本优化方法)</li>
</ul>
<p>内联做了什么？</p>
<ul>
<li>消除了函数调用本身的开销</li>
<li>允许编译器更有效地应用其他优化策略（比如<code>常量传播 cp</code>，<code>常量折叠 cf</code>，<code>死码消除</code>，<code>公共子表达式消除 CSE</code>，<code>循环不变代码移动</code>和<code>更好的寄存器分配</code>等）</li>
</ul>
<hr>
<p>内联的限制？</p>
<ul>
<li>不是所有的函数都可以内联，必须是简短且简单的函数</li>
<li>简短体现在，必须少于 40 个表达式</li>
<li>简单体现在，不能包含复杂的语句，比如 loop, label, closure, panic, recover, select, switch 等</li>
</ul>
<p>内联的越多开销就越少，为什么不尽可能使用内联呢？</p>
<p><em>内联可能会以增加程序大小来换取更快的执行时间</em>限制内联的最主要原因是，创建许多函数的内联副本会增加编译时间，并生成更大的二进制文件；内联收益最大的是“小函数”，相对于调用他们的开销来说，这些函数做很少的工作；随着函数大小的增长，函数内部做的工作与函数调用的开销相比，省下的时间越来越少；函数越大，通常越复杂，因此优化其内联形式相对于原地优化的好处会减少；</p>
<p><code>堆栈中间内联 (mid-stack)</code>
编译器默认不内联“堆栈中间函数”mid-stack（即调用了其他不可内联的函数）；堆栈中间内联可以提升性能，但是编译的二进制文件大小会增加；</p>
<p><code>快速路径内联</code></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMTA4Njc0OQ==&amp;mid=2651453599&amp;idx=1&amp;sn=6925019b1150ffd68b36092cff97ea64" target="_blank" rel="noopener noreferrer">一文搞懂 Go 内联优化</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="逃逸分析">逃逸分析<a href="#逃逸分析" class="hash-link" aria-label="Direct link to 逃逸分析" title="Direct link to 逃逸分析">​</a></h3>
<ul>
<li><em>什么是逃逸分析？为啥编译器要逃逸分析？golang 中有哪些可能出现逃逸的场景？怎么确定是否逃逸？</em></li>
</ul>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">####</span><span class="token title important"> 概念：什么是逃逸分析？为啥编译器要逃逸分析？</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token blockquote punctuation" style="color:#393A34">&gt;</span><span class="token plain"> 什么是逃逸分析？为什么编译器要进行逃逸分析？</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token italic content">逃逸分析是一种确定指针动态范围的方法，简单来说就是分析在程序的哪些地方可以访问到该指针</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 简单的说，它是在对变量放到堆上还是栈上进行分析，该分析在编译阶段完成。如果一个变量超过了函数调用的 生命周期，也就是这个变量在函数外部存在引用，编译器会把这个变量分配到堆上，这时我们就说这个变量发生逃逸了。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token italic content">golang 编译器通过</span><span class="token italic content code-snippet code keyword" style="color:#00009f">`逃逸分析`</span><span class="token italic content">，决定把一个变量放在栈上，还是堆上。变量作用域跑出函数范围，就分配在栈上。否则就分配在堆上。</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> *检查“变量的生命周期”是否是完全可知的，如果通过检查，就分配在栈上。否则，就逃逸到堆上。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token blockquote punctuation" style="color:#393A34">&gt;</span><span class="token plain"> 为什么我们要了解逃逸分析？</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 理解编译时的逃逸分析，可以帮我们写出更好的程序。我们知道了变量分配在堆和栈上的区别，我们就可以</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token italic content">尽量写出分配在栈上的代码，堆上的变量变少了，可以减轻内存分配的开销，减小 gc 的压力，提高程序的运行速度。</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 因为我们想要提升程序性能，通过逃逸分析我们能够知道变量是分配到堆上还是栈上，如果分配到栈上，内存的分配和释放都是由编译器进行管理，分配和释放的速度非常快，如果分配到堆上，堆不像栈那样可以自动清理，它会引起频繁地进行 GC，而 GC 会占用比较大的系统开销。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token blockquote punctuation" style="color:#393A34">&gt;</span><span class="token plain"> 逃逸分析是怎么完成的？</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">先说结论，“编译器会根据变量是否被外部引用来决定是否逃逸”，对我们来说，我们不需要掌握编译器的这些逃逸分析规则，我们只需要通过</span><span class="token code-snippet code keyword" style="color:#00009f">`go build -gcflags &#x27;-m&#x27;`</span><span class="token plain">命令查看逃逸分析的情况就可以了；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">另外，写代码的时候，也要注意“不要盲目使用变量的指针作为函数参数，虽然他会减少复制操作；但是当参数是变量自身的时候，复制是在栈上完成的操作，开销远比变量逃逸后动态地在堆上分配内存少得多”；我们应该尽量少写逃逸的代码，提升程序的运行效率；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">details</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">summary</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">可能出现逃逸的场景？有哪几种情况会发生逃逸呢？</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">summary</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token italic content">变量类型不确定</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token plain">，比如使用 interface 类型会逃逸，因为编译时无法确定类型；优化方案是将类型设置为固定类型；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token italic content">变量大小不确定</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token italic content">返回指针类型，会发生逃逸</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token plain">；优化方案视情况而定；传参的时候，从逃逸分析的角度，什么时候应该传结构体，什么时候应该传结构体的指针呢？</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 如果结构体很大，就应该传指针。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 直接传结构体，需要值拷贝，但是这是在栈上完成的操作，开销比变量逃逸后动态地在堆上分配内存少很多。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token italic content">栈空间不足，就会发生逃逸；比如变量所占内存较大等情况</span><span class="token italic punctuation" style="color:#393A34">*</span><span class="token plain">；优化方案就是尽量设置容量，如果容量实在过大就没有办法了；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">details</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="编译原理">编译原理<a href="#编译原理" class="hash-link" aria-label="Direct link to 编译原理" title="Direct link to 编译原理">​</a></h3>
<ul>
<li>编译原理（词法分析和语法分析；生成中间码；目标代码；汇编；链接； 预处理；）</li>
<li>编译和解释（解释型语言；自举）</li>
<li>运行时（引用）</li>
</ul>
<div class="language-plantuml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plantuml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@startuml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">title 从源码到可执行文件到转化过程</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">participant 编译器 as Foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">participant 汇编器 as Foo1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">participant 链接器 as Foo2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x -&gt; Foo : 源码hello.go(文本)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">note over Foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">词法分析</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">语法分析</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">静态检查</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">生成中间码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">生成机器码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end note</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Foo -&gt; Foo1 : 汇编文件hello.s(文本)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Foo1 -&gt; Foo2 : 可重定位文件hello.o(二进制)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Foo2 -&gt;  x   : 可执行文件hello(二进制)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@enduml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><em><a href="https://mp.weixin.qq.com/s?__biz=MjM5Njg5NDgwNA==&amp;mid=2247490743&amp;idx=1&amp;sn=45fd166a87c01b511be1fb2b5f20e38e" target="_blank" rel="noopener noreferrer">万字图文 | 你写的代码是如何跑起来的？</a></em></p>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">###</span><span class="token title important"> 编译器的工作原理？编译器是如何工作的？</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">-</span><span class="token plain"> 编译器分前端和后端，后端用来“目标代码生成和优化”，比如 LLVM。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="goast语法树">go/ast语法树<a href="#goast语法树" class="hash-link" aria-label="Direct link to go/ast语法树" title="Direct link to go/ast语法树">​</a></h3>
<p>AST 树的作用？</p>
<p>语法检查、单测框架生成</p>
<p><a href="https://segmentfault.com/a/1190000039215176" target="_blank" rel="noopener noreferrer">利用 go/ast   语法树做代码生成 - 无风的内存空间 - SegmentFault 思否</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="zzz">zzz<a href="#zzz" class="hash-link" aria-label="Direct link to zzz" title="Direct link to zzz">​</a></h3>
<p><a href="https://colobu.com/2023/09/13/pgo/" target="_blank" rel="noopener noreferrer">PGO: 为你的 Go 程序提效 5%</a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzNTY5MzU2MA==&amp;mid=2247497141&amp;idx=1&amp;sn=0459901d47536d1460d8b025838245c8" target="_blank" rel="noopener noreferrer">PGO 是啥，咋就让 Go 更快更猛了？</a></p>
<p>golang1.20 发布，v1.21 实装</p>
<div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">根据程序的不同，可能会带来 2% ~ 7% 的性能提升，相应的，就可以节省服务器资源，省成本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">首先说了，对 golang 来说，或者对所有编程语言来说，提升性能是困难的，因为有各种制约因素无法同时兼顾。但是使用 PGO 就可以比较简单地提升性能。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">什么 是“基于 profile 指导的优化”?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">当你构建一个 Go 二进制文件时，Go 编译器会执行优化，试图生成性能最佳的二进制文件。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">例如，常量传播 (constant propagation) 可以在编译时计算常量表达式的值，避免了运行时的计算开销。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">逃逸分析 (Escape analysis) 可以避免为局部作用域的对象分配堆内存，从而避免 GC 的开销。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">内联 (Inlining) 会将简单函数的函数体拷贝到调用者中，这通常可以在调用者中启用进一步的优化 (例如额外的常量传播或更好的逃逸分析)。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">去虚拟化 (Devirtualization) 会将接口值上的间接调用 (如果可以静态确定其类型) 转换为对具体方法的直接调用 (这通常可以内联该调用)。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">使用应用程序行为的 profile 进行编译器优化称为基于 profile 指导的优化 (PGO)(也称为性能分析引导优化、反馈导向优化 (FDO))。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://blackglory.me/notes/compiler" target="_blank" rel="noopener noreferrer">编译器 笔记 - BlackGlory</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-10-25T03:40:42.000Z" itemprop="dateModified">Oct 25, 2024</time></b> by <b>XBPk3T</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#编译原理之美" class="table-of-contents__link toc-highlight">《编译原理之美》</a></li><li><a href="#编译原理实战课" class="table-of-contents__link toc-highlight">《编译原理实战课》</a></li><li><a href="#用go语言自制编译器" class="table-of-contents__link toc-highlight">《用Go语言自制编译器》</a></li><li><a href="#高级编译器设计与实现" class="table-of-contents__link toc-highlight">《高级编译器设计与实现》</a></li><li><a href="#编译器设计" class="table-of-contents__link toc-highlight">《编译器设计》</a></li><li><a href="#wip-golang-compiler" class="table-of-contents__link toc-highlight">[WIP] golang compiler</a><ul><li><a href="#golang-编译由哪几个阶段构成" class="table-of-contents__link toc-highlight">golang 编译由哪几个阶段构成？</a></li><li><a href="#对-golang-编译器有哪些优化" class="table-of-contents__link toc-highlight">对 golang 编译器有哪些优化？</a></li><li><a href="#ssa-是什么及其特点" class="table-of-contents__link toc-highlight">SSA 是什么？及其特点？</a></li><li><a href="#内联" class="table-of-contents__link toc-highlight">内联</a></li><li><a href="#逃逸分析" class="table-of-contents__link toc-highlight">逃逸分析</a></li><li><a href="#编译原理" class="table-of-contents__link toc-highlight">编译原理</a></li><li><a href="#goast语法树" class="table-of-contents__link toc-highlight">go/ast语法树</a></li><li><a href="#zzz" class="table-of-contents__link toc-highlight">zzz</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Docs. Built with Docusaurus. Hosted by Github & Cloudflare.</div></div></div></footer></div>
</body>
</html>